{
  "openapi": "3.1.0",
  "info": {
    "title": "Aletheia Deep Research API",
    "description": "\n    ## üîç API para an√°lisis e investigaci√≥n profunda\n    \n    Esta API proporciona capacidades avanzadas de investigaci√≥n utilizando:\n    \n    - **Investigaci√≥n Iterativa**: B√∫squeda profunda con m√∫ltiples iteraciones\n    - **Procesamiento Paralelo**: Optimizado para alto rendimiento\n    - **Trazabilidad Completa**: Monitoreo y observabilidad con OpenTelemetry\n    - **M√∫ltiples Fuentes**: Integraci√≥n con Tavily y Saptiva APIs\n    \n    ### üìã Casos de Uso\n    \n    - An√°lisis de mercado y competencia\n    - Investigaci√≥n acad√©mica y cient√≠fica  \n    - Due diligence empresarial\n    - Monitoreo de tendencias\n    \n    ### üöÄ Caracter√≠sticas\n    \n    - ‚úÖ Auto-escalado en Kubernetes\n    - ‚úÖ CI/CD enterprise-grade\n    - ‚úÖ Seguridad y compliance\n    - ‚úÖ M√©tricas de calidad\n    ",
    "contact": {
      "name": "Aletheia Development Team",
      "url": "https://github.com/saptiva-ai/alethia_deepresearch",
      "email": "dev@saptiva.ai"
    },
    "license": {
      "name": "MIT License",
      "url": "https://opensource.org/licenses/MIT"
    },
    "version": "0.7.0"
  },
  "paths": {
    "/health": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Estado del sistema",
        "description": "Verifica el estado de salud de la API y la disponibilidad de servicios externos",
        "operationId": "health_check_health_get",
        "responses": {
          "200": {
            "description": "Sistema funcionando correctamente",
            "content": {
              "application/json": {
                "schema": {},
                "example": {
                  "status": "healthy",
                  "service": "Aletheia Deep Research API",
                  "version": "0.7.0",
                  "api_keys": {
                    "saptiva_available": true,
                    "tavily_available": true
                  },
                  "cached": false,
                  "timestamp": 1726179600.0
                }
              }
            }
          }
        }
      }
    },
    "/research": {
      "post": {
        "tags": [
          "research"
        ],
        "summary": "Iniciar investigaci√≥n est√°ndar",
        "description": "Inicia una nueva tarea de investigaci√≥n con procesamiento paralelo optimizado.\n    \n    - **Procesamiento as√≠ncrono**: La investigaci√≥n se ejecuta en segundo plano\n    - **Optimizaci√≥n paralela**: M√∫ltiples sub-tareas ejecutadas simult√°neamente  \n    - **M√∫ltiples fuentes**: Integraci√≥n con Tavily y Saptiva APIs\n    - **Alta disponibilidad**: Contin√∫a funcionando aunque algunas APIs no est√©n disponibles",
        "operationId": "start_research_research_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResearchRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Tarea de investigaci√≥n aceptada y en ejecuci√≥n",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TaskStatus"
                },
                "example": {
                  "task_id": "550e8400-e29b-41d4-a716-446655440000",
                  "status": "accepted",
                  "details": "Research task has been accepted and is running with optimized parallel processing."
                }
              }
            }
          },
          "400": {
            "description": "Par√°metros de solicitud inv√°lidos"
          },
          "500": {
            "description": "Error interno del servidor"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/tasks/{task_id}/status": {
      "get": {
        "tags": [
          "tasks"
        ],
        "summary": "Consultar estado de tarea",
        "description": "Obtiene el estado actual de una tarea de investigaci√≥n espec√≠fica",
        "operationId": "get_task_status_tasks__task_id__status_get",
        "parameters": [
          {
            "name": "task_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Task Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Estado de la tarea recuperado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TaskStatus"
                },
                "example": {
                  "task_id": "550e8400-e29b-41d4-a716-446655440000",
                  "status": "completed",
                  "details": "Research completed with 15 evidence sources"
                }
              }
            }
          },
          "404": {
            "description": "Tarea no encontrada"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/reports/{task_id}": {
      "get": {
        "tags": [
          "reports"
        ],
        "summary": "Obtener reporte de investigaci√≥n",
        "description": "Recupera el resultado completo de una tarea de investigaci√≥n incluyendo el reporte y fuentes",
        "operationId": "get_report_reports__task_id__get",
        "parameters": [
          {
            "name": "task_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Task Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reporte recuperado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Report"
                },
                "example": {
                  "status": "completed",
                  "report_md": "# An√°lisis del Mercado de IA en 2025\n\n## Resumen Ejecutivo\n...",
                  "sources_bib": "Generated from 15 evidence sources",
                  "metrics_json": "{\"mock_metric\": 1.0}"
                }
              }
            }
          },
          "404": {
            "description": "Reporte no encontrado"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/traces/{task_id}": {
      "get": {
        "tags": [
          "observability"
        ],
        "summary": "Obtener trazas de observabilidad",
        "description": "Recupera artefactos de trazabilidad y observabilidad para una tarea espec√≠fica.\n    \n    Incluye:\n    - **Manifiesto**: Configuraci√≥n y metadatos de la ejecuci√≥n\n    - **Eventos**: Log de eventos en formato NDJSON para an√°lisis\n    - **OpenTelemetry**: Trazas de rendimiento y monitoreo",
        "operationId": "get_traces_traces__task_id__get",
        "parameters": [
          {
            "name": "task_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Task Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trazas recuperadas exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Traces"
                },
                "example": {
                  "manifest_json": "{\"version\": \"0.7.0\", \"task_type\": \"research\", \"started_at\": \"2025-09-12T10:00:00Z\"}",
                  "events_ndjson": "{\"event\": \"task_started\", \"timestamp\": \"2025-09-12T10:00:00Z\"}\n{\"event\": \"plan_created\", \"subtasks\": 5}",
                  "otel_export_json": "{\"trace_id\": \"abc123\", \"spans\": [{\"name\": \"research_task\", \"duration_ms\": 1250}]}"
                }
              }
            }
          },
          "404": {
            "description": "Tarea no encontrada"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/deep-research": {
      "post": {
        "tags": [
          "deep-research"
        ],
        "summary": "Iniciar investigaci√≥n profunda iterativa",
        "description": "Inicia una investigaci√≥n profunda usando el patr√≥n Together AI con refinamiento iterativo.\n    \n    ### üîÑ Caracter√≠sticas de Deep Research:\n    - **Refinamiento iterativo**: M√∫ltiples ciclos de an√°lisis y mejora\n    - **Score de completitud**: Evaluaci√≥n autom√°tica de calidad\n    - **Gap analysis**: Identificaci√≥n autom√°tica de brechas de informaci√≥n\n    - **Control de presupuesto**: L√≠mites configurables de recursos\n    \n    ### üìä M√©tricas de Calidad:\n    - Completion level (0.0 - 1.0)\n    - Research quality score \n    - Evidence count tracking\n    - Execution time monitoring",
        "operationId": "start_deep_research_deep_research_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeepResearchRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Tarea de investigaci√≥n profunda aceptada",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TaskStatus"
                },
                "example": {
                  "task_id": "deep-550e8400-e29b-41d4-a716-446655440000",
                  "status": "accepted",
                  "details": "Deep research task accepted with parallel processing. Configuration: 5 iterations, 0.85 min score."
                }
              }
            }
          },
          "400": {
            "description": "Par√°metros de configuraci√≥n inv√°lidos"
          },
          "500": {
            "description": "Error interno del servidor"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/deep-research/{task_id}": {
      "get": {
        "tags": [
          "deep-research"
        ],
        "summary": "Obtener reporte de investigaci√≥n profunda",
        "description": "Recupera el resultado completo de una investigaci√≥n profunda incluyendo m√©tricas de calidad.\n    \n    ### üìä Contenido del Reporte:\n    - **Reporte final**: Documento completo en Markdown\n    - **Resumen de investigaci√≥n**: Estructura de datos con hallazgos clave\n    - **M√©tricas de calidad**: Scores de completitud y evidencia\n    - **Bibliografia**: Referencias de todas las fuentes consultadas",
        "operationId": "get_deep_research_report_deep_research__task_id__get",
        "parameters": [
          {
            "name": "task_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Task Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reporte de investigaci√≥n profunda recuperado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeepResearchReport"
                },
                "example": {
                  "status": "completed",
                  "report_md": "# Impacto de AI Act en Startups Europeas\n\n## An√°lisis Profundo\n...",
                  "sources_bib": "Generated from 42 evidence sources",
                  "research_summary": {
                    "iterations_completed": 3,
                    "gaps_identified": [
                      "regulatory_compliance",
                      "market_impact"
                    ],
                    "key_findings": [
                      "High compliance costs",
                      "Market consolidation likely"
                    ]
                  },
                  "quality_metrics": {
                    "completion_level": 0.95,
                    "quality_score": 0.88,
                    "evidence_count": 42,
                    "execution_time": 127.3
                  }
                }
              }
            }
          },
          "404": {
            "description": "Tarea de investigaci√≥n profunda no encontrada"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "DeepResearchReport": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Estado del reporte",
            "example": "completed"
          },
          "report_md": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Report Md",
            "description": "Contenido del reporte final en Markdown"
          },
          "sources_bib": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Sources Bib",
            "description": "Bibliograf√≠a de fuentes consultadas"
          },
          "research_summary": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Research Summary",
            "description": "Resumen estructurado de la investigaci√≥n"
          },
          "quality_metrics": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Quality Metrics",
            "description": "M√©tricas de calidad de la investigaci√≥n",
            "example": {
              "completion_level": 0.95,
              "evidence_count": 42,
              "execution_time": 127.3,
              "quality_score": 0.88
            }
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "DeepResearchReport",
        "description": "Reporte de investigaci√≥n profunda con m√©tricas de calidad."
      },
      "DeepResearchRequest": {
        "properties": {
          "query": {
            "type": "string",
            "title": "Query",
            "description": "Consulta principal de investigaci√≥n profunda",
            "example": "Impacto de la regulaci√≥n AI Act en startups europeas"
          },
          "scope": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Scope",
            "description": "Alcance espec√≠fico de la investigaci√≥n",
            "example": "startup_ecosystem_europa"
          },
          "max_iterations": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 10.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Iterations",
            "description": "M√°ximo n√∫mero de iteraciones de refinamiento",
            "default": 3,
            "example": 5
          },
          "min_completion_score": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 1.0,
                "minimum": 0.1
              },
              {
                "type": "null"
              }
            ],
            "title": "Min Completion Score",
            "description": "Score m√≠nimo de completitud para finalizar",
            "default": 0.75,
            "example": 0.85
          },
          "budget": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 5000.0,
                "exclusiveMinimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Budget",
            "description": "Presupuesto total para la investigaci√≥n",
            "default": 100,
            "example": 200
          }
        },
        "type": "object",
        "required": [
          "query"
        ],
        "title": "DeepResearchRequest",
        "description": "Solicitud para investigaci√≥n iterativa profunda usando patr√≥n Together AI."
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "Report": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Estado del reporte",
            "example": "completed"
          },
          "report_md": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Report Md",
            "description": "Contenido del reporte en Markdown"
          },
          "sources_bib": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Sources Bib",
            "description": "Bibliograf√≠a de fuentes consultadas",
            "example": "Generated from 15 evidence sources"
          },
          "metrics_json": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Metrics Json",
            "description": "M√©tricas de calidad en formato JSON"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "Report",
        "description": "Reporte de investigaci√≥n est√°ndar."
      },
      "ResearchRequest": {
        "properties": {
          "query": {
            "type": "string",
            "title": "Query",
            "description": "Consulta de investigaci√≥n",
            "example": "An√°lisis del mercado de inteligencia artificial en 2025"
          },
          "scope": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Scope",
            "description": "Alcance espec√≠fico de la investigaci√≥n",
            "example": "mercado_latinoamericano"
          },
          "budget": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 1000.0,
                "exclusiveMinimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Budget",
            "description": "Presupuesto m√°ximo para fuentes de datos",
            "example": 50.0
          }
        },
        "type": "object",
        "required": [
          "query"
        ],
        "title": "ResearchRequest",
        "description": "Solicitud para investigaci√≥n est√°ndar con procesamiento paralelo optimizado."
      },
      "TaskStatus": {
        "properties": {
          "task_id": {
            "type": "string",
            "title": "Task Id",
            "description": "Identificador √∫nico de la tarea",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Estado actual de la tarea",
            "example": "completed"
          },
          "details": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details",
            "description": "Detalles adicionales del estado",
            "example": "Investigaci√≥n completada con 15 fuentes"
          }
        },
        "type": "object",
        "required": [
          "task_id",
          "status"
        ],
        "title": "TaskStatus",
        "description": "Estado de una tarea de investigaci√≥n."
      },
      "Traces": {
        "properties": {
          "manifest_json": {
            "type": "string",
            "title": "Manifest Json",
            "description": "Manifiesto de la ejecuci√≥n"
          },
          "events_ndjson": {
            "type": "string",
            "title": "Events Ndjson",
            "description": "Eventos de trazabilidad en formato NDJSON"
          },
          "otel_export_json": {
            "type": "string",
            "title": "Otel Export Json",
            "description": "Exportaci√≥n de trazas OpenTelemetry"
          }
        },
        "type": "object",
        "required": [
          "manifest_json",
          "events_ndjson",
          "otel_export_json"
        ],
        "title": "Traces",
        "description": "Artefactos de trazabilidad y observabilidad."
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      }
    }
  },
  "tags": [
    {
      "name": "health",
      "description": "Endpoints de estado y monitoreo del sistema"
    },
    {
      "name": "research",
      "description": "Investigaci√≥n est√°ndar con procesamiento paralelo optimizado"
    },
    {
      "name": "deep-research",
      "description": "Investigaci√≥n iterativa profunda usando patr√≥n Together AI"
    },
    {
      "name": "tasks",
      "description": "Gesti√≥n y seguimiento de tareas de investigaci√≥n"
    },
    {
      "name": "reports",
      "description": "Generaci√≥n y recuperaci√≥n de reportes"
    },
    {
      "name": "observability",
      "description": "Trazabilidad y m√©tricas de rendimiento"
    }
  ]
}